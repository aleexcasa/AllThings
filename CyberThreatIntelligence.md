<h1 align="center">
<br>
  <img src="https://images.squarespace-cdn.com/content/v1/5ef07334254666386ed45a91/1620182935772-Q2JSR2QZDSLL8BXJZ586/Cyber+Threat+Intelligence+Sources+2021.png" alt="Front-End Checklist" width="400">
  <br>
  Cyber Threat Intelligence
  <br>
</h1>

<h4 align="center">HOLA :D</h4>

---

# Índice

- [¿Qué es la Inteligencia?](#qué-es-la-inteligencia)
- [¿Qué es el Análisis de Inteligencia?](#qué-es-el-análisis-de-inteligencia)
- [¿Quien es el padre del análisis de inteligencia estratégica?](#quien-es-el-padre-del-análisis-de-inteligencia-estratégica)
- [¿Cual es el Ciclo de la Inteligencia?](#cual-es-el-ciclo-de-la-inteligencia)
    - [Tipos de Recopilación de Inteligencia](#tipos-de-recopilación-de-inteligencia)
    - [Categorías de Inteligencia acabada](#categorías-de-inteligencia-acabada)
- [¿Cómo se define el OSINT?](#cómo-se-define-el-osint)
- [¿Qué es la Ciberinteligencia?](#qué-es-la-ciberinteligencia)
- [¿Qué es la Inteligencia de Amenazas?](#qué-es-la-inteligencia-de-amenazas)
    - [¿Cuales són los tipos de Inteligencia de Amenazas?](#cuales-són-los-tipos-de-inteligencia-de-amenazas)
- [¿Qué preguntas se tiene que hacer un buen CTI?](#qué-preguntas-se-tiene-que-hacer-un-buen-cti)
- [Inteligencia de amenazas estratégica](#inteligencia-de-amenazas-estratégica)
    - [Porporciona respuestas sobre:](#porporciona-respuestas-sobre)
    - [Protección de marca](#protección-de-marca)
- [Características de una amenaza](#características-de-una-amenaza)
    - [Obtención de inteligencia](#obtención-de-inteligencia)
    - [IOC (Indicadores de Compromiso)](#ioc-indicadores-de-compromiso)
    - [TTPs (Tácticas, Técnicas y Procedimientos)](#ttps-tácticas-técnicas-y-procedimientos)
    - [Analizar y organizar](#analizar-y-organizar)
    - [Puesta en común](#puesta-en-común)

---

## ¿Qué es la Inteligencia?

La inteligencia es el conocimiento y el conocimiento previo del mundo que nos rodea: el preludio de la decisión y la acción...

## ¿Qué es el Análisis de Inteligencia?

El análisis de inteligencia es el proceso de **evaluar y transformar los datos e información en conocimiento útil**.

Otro ejemplo **simplificado** de definición es:

```Proceso mediante el cual se analiza una situación de la forma más objetiva posible, emitiendo un informe que ayude a comprenderla mejor.```

## ¿Quién es el padre del análisis de inteligencia estratégica?

El padre del análisis en inteligencia estratégica fue el analista de la Oficina de Servicios Estratégicos (OSS) y de la CIA, **Sherman Kent**.

Sherman Kent realición una Doctrina analítica con 9 principios:

1.  **Focus on Policymaker Concerns:** Proporcionar inteligencia "procesable" que pueda ayudar a frenar las amenazas y aprovechar las oportunidades.
2.  **Avoidance of a Personal Policy Agenda:** Proporcionar inteligencia sin posicionamiento moral, político o ideológico.
3.  **Intellectual Rigor:** Evaluar rigurosamente la validez de la información. Evitar hacer predicciones.
4.  **Consciuos Effort to Avoid Analytic Biases:** Evitar sesgos cognitivos y ser consciente de la realidad objetiva.
5.  **Willingness to Consider Other Judgments:** Compartir y debatir otras opiniones con otros analistas para enriquecer el resultado final.
6.  **Systematic Use of Outside Experts:** Mantenerse al día con los eventos publicados y clasificados.
7.  **Collective Responsability for Judgment:** Dejar claro la fuente para evitar errores.
8.  **Effective Communication of policy-support information and judgments:** Evitar el "puede" o "podría" para evitar confusión.
9.  **Candid Admission of Mistakes:** Reconoce los errores que cometas.

## ¿Cuál es el Ciclo de la Inteligencia?

1. **Planificación:** Determina que problemas deben abordarse y qué información debe recopilarse para proporcionar las respuestas adecuadas.
2. **Recoleción:** Recopilación de información sin procesar de muchas fuentes diferentes.
3. **Procesado:** Sintetizar la inteligencia en bruto en un estado utilizable.
4. **Análisis:** Integrar, evaluar y analizar todos los datos disponibles y destilarlos en productos de inteligencia finales.
5. **Difusión:** Distribuir productos de inteligencia a los formuladores de políticas que los solicitaron.
6. **Feedback:** Recibir información de si se han resulto todas las preguntas de los formuladores.

### Tipos de Recopilación de Inteligencia

-  Inteligencia son Inteligencia de señales (**SIGINT**)
-  Inteligencia de imágenes (**IMINT**)
-  Inteligencia de medición y firma (**MASINT**)
-  Inteligencia de fuentes humanas (**HUMINT**)
-  Inteligencia de código abierto (**OSINT**)
-  Inteligencia geoespacial (**GEOINT**)

### Categorías de Inteligencia acabada

- **Inteligencia actual** del día a día.
- **Inteligencia estimada** para evaluar posibles desarrollos.
- **Inteligencia de advertencia** para alarmar o avisar a los responsables.
- **Inteligencia científica y técnica** con un examen del desarrollo técnico, características, rendimiento y capacidades de tecnologías extranjeras.
- **Inteligencia de investigación** que admite otros productos de inteligencia terminados.

## ¿Cómo se define el OSINT?

La **inteligencia de fuentes abiertas** se define como inteligencia producida adecuada con el fin de abordar un requisito de inteligencia específico.

Sus orígenes se atribuyen a **William Donovan** como jefe de la **Oficina de Servicios Estratégicos**, que luego se convertiría en la CIA, por hacer junto su equipo, el análisis de **información pública** (periódicos, revistas y trasmisiones de radio) durante la Segunda Guerra Mundial.

## ¿Qué es la Ciberinteligencia?

La Ciberinteligencia es la **adquisición y el análisis** de información para **identificar, rastrear y predecir las capacidades, intenciones y actividades** cibernéticas que apoye la toma de decisiones.

## ¿Qué es la Inteligencia de Amenazas?

La inteligencia de amenazas es conocimiento basado en **evidencia, que incluye contexto, mecanismos, indicadores, implicaciones y consejos** orientados a la acción **sobre una amenaza o peligro existente o emergente para los activos**.

### ¿Cuáles són los tipos de Inteligencia de Amenazas?

-  **Estratégico:** Proporciona una **visión general amplia del panorama de amenazas** de una organización. Una buena inteligencia estratégica debe proporcionar información sobre áreas como los riesgos asociados con ciertas líneas de acción, patrones generales en las tácticas y objetivos de los actores de amenazas, y eventos y tendencias geopolíticas.
-  **Táctica:** Describe las rácticas, técnicas y procedimientos (**TTP**) de los actores de amenazas. Debería **ayudar a los defensores** a comprender, en términos específicos, cómo se puede atacar a su organización y las mejores formas de defenderse o mitigar esos ataques.
-  **Operacional:** Conocer sobre ciberataques, eventos o campañas. **Brinda información especializada** que **ayuda a los equipos de respuesta a incidentes** a comprender la naturaleza, la intención y el momento de ataques específicos.

## ¿Qué preguntas se tiene que hacer un buen CTI?

Un CTI (Cyber Threat Intelligence) es un **analista de Inteligencia de Amenazas Cibernéticas**.

- **Quiénes** son los adversarios.
- **Qué** usan los adversarios.
- **Donde** suelen atacar los adversarios.
- **Cuando** actúan los adversarios.
- **Por qué** atacan los adversarios.
- **Cómo** operan los adversarios.

``Un CTI debe poder comunicarse en lenguaje comercial, traduciendo la jerga de seguridad en comercial y viceversa.``

## Inteligencia de amenazas estratégica

### Porporciona respuestas sobre:

- ¿Quiénes son tus adversarios? Y ¿qué quieren?
- ¿Cuál es el imapcto financiero del ciberataque?
- ¿Qué actores de amenazas estan en tendencia y que tipo de ataques?
- ¿Qué información estadística hay sobre las filtraciones de datos?
- ¿Qué ciberataques afectan a empresas de la misma industria?
- ¿Ha habido ciberataques contra nuestra organización en el pasado, cuál ha sido el efecto?
- ¿Qué acciones son necesarias para reducir el perfil de riesgo?

### Protección de marca

La **protección de marca** para el CTI consiste en múltiples puntos de datos a considerar, incluidas **campañas de phishing**, **dominios falsos**, **cuentas falsas en redes sociales** y **páginas web explotadas**.

Evaluar los riesgos en cada área ayuda a comprender **cómo y por qué** los actores de amenazas **eligen las marcas** para explotar a clientes.

Preguntas:

- ¿Se han apoderado los acotres de amenazas de la infraestructura de Internet abierta existente u olvidada?
- ¿Deberían comprar espacio adicional para bloquear a los actores de amenazas?

Cosas a buscar o hacer:
````
· Activos Digitales [dominios, IP, CMS(Sistema de Gestión de Contenido), URL] si es posible desconocidos.
· Riesgo de superficie de ataque.
· Información de ciberataques específicos de la industria o espionaje industrial.
· Información de ciberataques geopolíticos.
· Monitorear actores de amenazas populares.
· Informes de ciberseguridad.
· Seguimiento de marcas.
· Detectar o escuchar amenazas como DDoS, Ransomware.
· Detectar y eliminar phshing.
· Encontrar filtraciones de datos y credenciales.
· Supervisar menciones de la Dark Web.
· Descubrir el uso no autorizado de logotipos, perfiles de ejecutivos falsos y apps falsas.
· Vulnerabilidades críticas de día cero que afecten a la organización.
````
## Características de una amenaza

Cada amenaza deja rastro asi que podemos aportar inteligencia sobre ellas gracias al OSINT.

### Obtención de inteligencia

Al obtenerse de fuentes abiertas o de un proveedor, es recomendable contratar dicha información en diversas fuentes.<br>
Un framework muy utilizado es <a href="https://www.misp-project.org/">MISP</a> (Malware Information Sharing Plataform), para subir información y augmentar la base de conocimiento de todos los miembros. 
Otra plataforma es <a href="https://attack.mitre.org/">MITRE ATT&CK</a> que contiene in unmenso volumen de inteligencia orientada a la emulación de APT (Amenaza Persistente Avanzada).

### IOC (Indicadores de Compromiso)

Los **IOCs** son una **tenconología estandarizada** que consiste en definir las características técnicas de una amenza a través **de las evidencias existentes** en un equipo comprometido.

<div align="center"><img src="https://www.securityartwork.es/wp-content/uploads/2021/11/image-4-740x418.png" width="400"></div><br>

- **Hashes**: *Útiles en corto plazo* y con el cambio de un solo bit el archivo produce un hash completamente diferente.
- **Direcciones IP**: *Útiles en corto plazo* y muy *sencillo de modificar*. A menudo se contratan contenedores en la nube como punto de ataque.
- **Dominios**:* Útiles y más complicados de modificar*, pero normalmente se utilizan miles de dominios diferentes para enmascarar las IPs. Además, normalmente s eusan nombres de dominio dinámicos como *duckdns* o *dyndns*.
- **Artefactos de host o de red**: *Útiles y complicados de modificar*, pueden ser archivos, comandos ejecutados, paquetes de red, etc. Aunque un mismo actor puede contar con nombres de archivos aleatorios, ofuscamiento de red o cambiar el *User Agent* de peticiones HTTP, entre otros para evitar el rastreo.
- **Herramientas**: *Muy útil y complicado de modificar*, se refiere a herramientas no nativas del sistema usadas para conseguir comprometer el sistema.

### TTPs (Tácticas, Técnicas y Procedimientos)

Esta es la inteligencia **mas difícil de obtener**, pero es **la más relevante** para el desarrollo de un plan de detección y respuesta.

*Para modificar este indicador tendria de cambiar por completo la forma de atacar*. <br>El Blue Team tendra de implementar reglas de correlación y agregación de alertas de fuentes diversas.

``En esta etapa, hay que construir un mapa de las TTPs del adversario.``

Se definen en:

- **Tácticas**: Son la *descripción de los objetivos de una acción* a alto nivel.
- **Técnicas**: Son *descripciones más exhaustivas de acciones ofensivas*, pero sin entrar en detalles particulares en función del OS o tipo de herramienta. Una técnica siempre está englobada dentro de una Táctica.
- **Subtécnicas**: Son una *descripción técnica de diferentes variantes de la técnica*.
- **Procedimientos**: Son los *pasos concretos, comandos, herramientas* y su uso para un caso particular.

### Analizar y organizar

La herramienta web de **MITRE** open source llamada <a href="https://mitre-attack.github.io/attack-navigator/">ATT&CK Navigator</a>, sirve para **representar gráficamente las TTPs de una amenaza**.
Mitre también cuenta con una recolección de grupos de APT y software con sus TTP asociadas.

### Puesta en común

Los encargados de los equipos deben revisar las TTPs ofrecidas por el equipo de CTI y elegir que TTPs serán emuladas durante el ejercicio.<br>
Las TTPs deben estar siendo usadas por los adversarios en la actualidad.

La herramienta gratuita <a href="https://vectr.io/">Vectr.io</a> se puede ver como **cordinar todos los elementos** del ejercicio y contar con una **base de conocimiento para el futuro** con el objetivo de estudiar la evolución de la postura de seguridad de la organización.
